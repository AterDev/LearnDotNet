# 控制台应用：编写命令

至今为止，我们所有的代码示例，用的就是控制台程序，一般称为`Console`。

今天通过一个实例，让大家编写一个控制台的程序，并能够安装和发布，真正变成可用的`命令行工具`。

## 程序设计

我们来实现一个简单的功能，比如给定一个IP地址，扫描其开放的端口。并将扫描结果保存到一个文件中。

## 代码实现

### 创建一个控制台程序

在命令行中，使用`dotnet new console -n PortScanner`创建一个控制台程序。

使用`VS Code`使用解决方案浏览器打开项目。

### 编写逻辑代码

创建`ScannerHelper.cs`，然后编写以下代码：

```csharp
using System.Net;
using System.Net.Sockets;

namespace PortScanner;

/// <summary>
/// 扫描帮助类
/// </summary>
public class ScannerHelper(IPAddress ip, int startPort, int endPort)
{
    public int StartPort { get; set; } = startPort;
    public int EndPort { get; set; } = endPort;
    public IPAddress IP { get; set; } = ip;

    public async Task<List<int>> ScanPortsAsync()
    {
        List<int> openPorts = [];
        for (int port = StartPort; port <= EndPort; port++)
        {
            using (var client = new TcpClient())
            {
                try
                {
                    var cancelTask = new CancellationTokenSource(1000);
                    await client.ConnectAsync(IP, port,cancelTask.Token);
                    if (client.Connected)
                    {
                        openPorts.Add(port);
                        Console.WriteLine($"{port} is open");
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine($"{port} isn't open:" + ex.Message);
                    continue;
                }
            }
        }
        return openPorts;
    }
}
```

## 发布程序

## 安装程序

## 使用命令行
